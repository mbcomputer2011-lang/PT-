name: Flutter Android Build # ‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á Workflow

on:
  push:
    branches: [ main ] # Trigger ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£ push ‡πÑ‡∏õ‡∏ó‡∏µ‡πà branch main
  pull_request:
    branches: [ main ] # Trigger ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ Pull Request ‡πÑ‡∏õ‡∏ó‡∏µ‡πà branch main

jobs:
  build:
    runs-on: ubuntu-latest # ‡∏£‡∏±‡∏ô‡∏ö‡∏ô Ubuntu ‡∏£‡∏∏‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î

    steps:
      - name: 1. Checkout code üì¶ # ‡∏î‡∏∂‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å Repository
        uses: actions/checkout@v4

      - name: 2. Setup Flutter SDK ‚öôÔ∏è # ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Flutter SDK
        # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡πÉ‡∏ä‡πâ action ‡∏ó‡∏µ‡πà‡∏ô‡∏¥‡∏¢‡∏°‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ
        uses: subosito/flutter-action@v2 
        with:
          flutter-version: '3.19.6' # ‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
          channel: 'stable' # ‡πÉ‡∏ä‡πâ channel stable

      - name: 3. Install Dependencies üíª # ‡∏£‡∏±‡∏ô pub get ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies
        run: flutter pub get
        # ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏ working-directory ‡∏´‡∏≤‡∏Å pubspec.yaml ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà Root ‡∏Ç‡∏≠‡∏á project

      - name: 4. Cache Flutter Packages üíæ # Cache package ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ build ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ
        uses: actions/cache@v4
        with:
          path: |
            ~/.pub-cache
          key: ${{ runner.os }}-flutter-${{ hashFiles('**/pubspec.lock') }} # ‡πÉ‡∏ä‡πâ pubspec.lock ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥

      - name: 5. Build Flutter APK - Release üöÄ # ‡∏™‡∏£‡πâ‡∏≤‡∏á APK ‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î Release
        # ‡πÄ‡∏û‡∏¥‡πà‡∏° run: ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á
        run: flutter build apk --release
        # ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏ working-directory ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏£‡∏±‡∏ô‡∏à‡∏≤‡∏Å Root ‡∏Ç‡∏≠‡∏á project

      - name: 6. Upload APK artifact ‚¨ÜÔ∏è # Upload ‡πÑ‡∏ü‡∏•‡πå APK ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô Artifact
        uses: actions/upload-artifact@v4
        with:
          name: release-apk
          path: build/app/outputs/flutter-apk/app-release.apk
          # Path ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠ build/app/outputs/flutter-apk/app-release.apk

      # ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≤‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£ Run Tests ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ APK ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
